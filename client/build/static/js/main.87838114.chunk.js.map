{"version":3,"sources":["Login.jsx","TrackSearchResult.jsx","Player.jsx","Dashboard.jsx","useAuth.jsx","App.jsx","index.jsx"],"names":["Login","Container","style","minHeight","className","href","TrackSearchResult","props","cursor","onClick","chooseTrack","track","src","albumURL","height","alt","title","artist","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","callback","state","isPlaying","showSaveIcon","uris","SpotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","window","history","pushState","catch","err","location","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.87838114.chunk.js","sourcesContent":["import React from 'react'\nimport { Container } from 'react-bootstrap'\n\nconst AUTH_URL = 'https://accounts.spotify.com/authorize?client_id=250a9153ab334c6cba6723476cf799eb&response_type=code&redirect_uri=http://localhost:3000&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state'\n\nexport default function Login() {\n    return (\n        <Container style={{minHeight: '100vh'}} className='d-flex justify-content-+center align-items-center'>\n            <a className=\"btn btn-success btn-lg\" href={AUTH_URL}>Log In With Spotify</a>\n        </Container>\n    )\n}\n","import React from 'react'\n\nexport default function TrackSearchResult(props) {\n    \n    function handlePlay() {\n        props.chooseTrack(props.track)\n    }\n       \n    return (\n        <div className='d-flex m-2 align-items-center' style={{cursor: 'pointer'}} onClick={handlePlay}>\n            <img src={props.track.albumURL} style={{height: '64px' }} alt='' />\n            <div className='ml-3'>\n                <div>{props.track.title}</div>\n                <div className='text-muted'>{props.track.artist}</div>\n            </div>\n        </div>\n    )\n}\n","import React, {useEffect, useState} from 'react'\nimport SpotifyWebPlayer from 'react-spotify-web-playback'\n\nexport default function Player({accessToken, trackUri}) {\n    const [play, setPlay] = useState(false)\n    \n    useEffect(() => {\n        trackUri ? setPlay(true) : null\n    }, [trackUri])\n    \n    if (!accessToken) return null\n    return <SpotifyWebPlayer token={accessToken} callback = {state => {if (!state.isPlaying) {setPlay(false)}}} showSaveIcon play={play} uris={trackUri ? [trackUri] : []} />\n}","import {useState, useEffect} from 'react'\nimport {Container, Form} from 'react-bootstrap';\nimport useAuth from './useAuth';\nimport SpotifyWebApi from 'spotify-web-api-node'\nimport TrackSearchResult from './TrackSearchResult'\nimport Player from './Player';\nimport axios from 'axios';\n\nconst SpotifyApi = new SpotifyWebApi({\n    clientId: '250a9153ab334c6cba6723476cf799eb'\n})\n\nexport default function Dashboard({ code }) {\n    const accessToken = useAuth(code)\n    const [search, setSearch] = useState('')\n    const [searchResults, setSearchResults] = useState([])\n    const [playingTrack, setPlayingTrack] = useState()\n    const [lyrics, setLyrics] = useState('')\n    \n    function chooseTrack(track) {\n        setPlayingTrack(track)\n        setSearchResults([])\n        setLyrics('')\n    }\n    \n    useEffect(() => {\n        if (!playingTrack) return\n        axios.get('http://localhost:3001/lyrics', {\n            params: {\n                track: playingTrack.title,\n                artist: playingTrack.artist\n            }\n        }).then(res => {\n            setLyrics(res.data.lyrics)\n        })\n    }, [playingTrack])\n    \n    useEffect(() => {\n        if (!accessToken) return\n        SpotifyApi.setAccessToken(accessToken)\n    }, [accessToken])\n    \n    useEffect(() => {\n        if (!search) return setSearchResults([])\n        if (!accessToken) return \n        \n        let cancel = false\n        \n        SpotifyApi.searchTracks(search).then(res => {\n            if (cancel) return \n            setSearchResults(res.body.tracks.items.map(track => {\n                const smallestAlbumImage = track.album.images.reduce((smallest, image) => {\n                    if (image.height < smallest.height) return image\n                    return smallest\n                }, track.album.images[0])\n                return{\n                    artist: track.artists[0].name,\n                    title: track.name,\n                    uri: track.uri,\n                    albumURL: smallestAlbumImage.url\n                    \n                }\n            })\n        )})\n        return () => cancel = true\n    }, [search, accessToken])\n    \n    return (\n            <Container className='d-flex flex-column py-2' style={{height: '100vh'}}>\n                <Form.Control type='search' placeholder='Search Songs/Artists' value={search} onChange={e => {setSearch(e.target.value)}} />\n                <div className='flex-grow-1 my-2' style={{overflowY: 'auto'}}>\n                     {searchResults.map(track => (\n                        <TrackSearchResult\n                            track={track}\n                            key={track.uri}\n                            chooseTrack={chooseTrack}\n                        />\n                     ))}\n                     {searchResults.length === 0 && (\n                        <div className='text-center' style={{whiteSpace: 'pre'}}>{lyrics}</div>\n                     )}\n                </div>\n                <div><Player accessToken={accessToken} trackUri={playingTrack?.uri} /></div>\n            </Container>\n    )\n}","import React, { useState, useEffect } from 'react'\nimport axios from 'axios'\n\nexport default function useAuth(code) {\n    const [accessToken, setAccessToken] = useState()\n    const [refreshToken, setRefreshToken] = useState()\n    const [expiresIn, setExpiresIn] = useState()\n\n    useEffect(() => {\n        axios.post('http://localhost:3001/login', { code }).then(res => {\n            setAccessToken(res.data.accessToken)\n            setRefreshToken(res.data.refreshToken)\n            setExpiresIn(res.data.expiresIn)\n            window.history.pushState({}, null, '/')\n        }).catch((err) => {\n            window.location = '/'\n        })\n    }, [code])\n\n    useEffect(() => {\n        if (!refreshToken || !expiresIn) return \n        const interval = setInterval(() => {\n            axios.post('http://localhost:3001/refresh', { refreshToken }).then(res => {\n                setAccessToken(res.data.accessToken)\n                setExpiresIn(res.data.expiresIn)\n            }).catch((err) => {\n                window.location = '/'\n            }) \n        }, (expiresIn - 60) * 1000)\n        return () => clearInterval(interval)\n    }, [refreshToken, expiresIn])\n\n    return accessToken\n}","import 'bootstrap/dist/css/bootstrap.min.css'\nimport Login from './Login'\nimport Dashboard from './Dashboard'\n\nconst code = new URLSearchParams(window.location.search).get('code')\n\nfunction App() {\n  return (\n   code ? <Dashboard code={code} /> : <Login />\n  );\n}\n\nexport default App;\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}